<div class="form-group col-6">
  <label>Attribute</label>

  <ng-select
    [items]="dropdownOptions"
    bindLabel="label"
    bindValue="value"
    [(ngModel)]="selectedAttributes"
    [multiple]="true"
    [closeOnSelect]="false"
    [hideSelected]="false"
    [searchable]="false"
    [clearable]="false"
    [compareWith]="compareValues">

    <!-- OPTIONAL SELECT ALL -->
    <ng-template ng-header-tmp>
      <div class="option-row"
           (click)="toggleSelectAll()"
           style="display:flex; align-items:center; gap:8px; padding:6px 4px; cursor:pointer;">
        
        <input type="checkbox" [checked]="isAllSelected()" />
        <span>Select All</span>
      </div>
    </ng-template>

    <!-- MAIN DROPDOWN OPTIONS -->
    <ng-template ng-option-tmp let-item="item">
      <div class="option-row"
           (click)="toggleRow(item.value)"
           style="display:flex; align-items:center; gap:8px; padding:6px 4px; cursor:pointer; width:100%;">
        
        <input type="checkbox"
               [checked]="selectedAttributes.includes(item.value)"
               (click)="$event.stopPropagation()" />

        <span style="flex:1">{{ item.label }}</span>
      </div>
    </ng-template>

  </ng-select>
</div>



dropdownOptions = [
  { label: 'Activity code', value: 'ACT_CODE' },
  { label: 'Activation Date', value: 'ACT_DATE' },
  { label: 'Market Type', value: 'MARKET' },
  { label: 'Booking Entity', value: 'BOOKING' },
  // Add all your options here...
];

selectedAttributes: string[] = [];

compareValues = (a: any, b: any) => a === b;

// Toggle when clicking row OR checkbox
toggleRow(value: string) {
  const idx = this.selectedAttributes.indexOf(value);

  if (idx === -1) {
    this.selectedAttributes = [...this.selectedAttributes, value];
  } else {
    this.selectedAttributes = this.selectedAttributes.filter(v => v !== value);
  }
}

// ---- OPTIONAL: SELECT ALL ----
toggleSelectAll() {
  if (this.isAllSelected()) {
    this.selectedAttributes = [];
  } else {
    this.selectedAttributes = this.dropdownOptions.map(o => o.value);
  }
}

isAllSelected(): boolean {
  return this.selectedAttributes.length === this.dropdownOptions.length;
}

// ---- If nothing selected â†’ send all ----
getFinalAttributes() {
  return this.selectedAttributes.length === 0
    ? this.dropdownOptions.map(o => o.value)
    : this.selectedAttributes;
}

// ---- Comma-separated values ----
getCommaSeparated() {
  return this.getFinalAttributes().join(',');
}




